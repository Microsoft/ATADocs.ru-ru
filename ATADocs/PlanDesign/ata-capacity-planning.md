---
title: "Планирование развертывания ATA | Microsoft ATA"
description: "В этой статье содержатся сведения, которые помогут запланировать развертывание и определить, сколько серверов ATA потребуется для поддержки сети"
keywords: 
author: rkarlin
manager: stevenpo
ms.date: 04/28/2016
ms.topic: get-started-article
ms.prod: identity-ata
ms.service: advanced-threat-analytics
ms.technology: security
ms.assetid: 279d79f2-962c-4c6f-9702-29744a5d50e2
ms.reviewer: bennyl
ms.suite: ems
translationtype: Human Translation
ms.sourcegitcommit: a5c7163bc7b1989672e587bfb4fa6a65cd4e3751
ms.openlocfilehash: a43184e0efa1de110f5c287c6079e80e1a9dd3de


---

# Планирование производительности ATA
В этой статье содержатся сведения, которые помогут определить, сколько серверов ATA потребуется для поддержки сети, а также понять, сколько шлюзов ATA и упрощенных шлюзов ATA и какой уровень производительности сервера понадобится для центра ATA и шлюзов ATA.

## Определение размера и количества ресурсов для центра ATA
Чтобы проанализировать поведение пользователя, центру ATA требуются данные минимум за 30 дней. Ниже указаны сведения о пространстве на диске, которое необходимо базе данных ATA для одного контроллера домена. Чтобы вычислить весь объем пространства, необходимый для базы данных ATA, при наличии нескольких контроллеров домена, необходимо суммировать требуемый объем места на диске для каждого контроллера домена.
> [!NOTE] 
> При запуске в качестве динамической памяти виртуальной машины или любой другой памяти функция воздушного шага не поддерживается.

|Пакетов в секунду&#42;|Число ядер ЦП&#42;&#42;|Память (ГБ)|Объем хранилища базы данных в день (ГБ)|Объем хранилища базы данных в месяц (ГБ)|Операции ввода-вывода в секунду&#42;&#42;&#42;|
|---------------------------|-------------------------|-------------------|---------------------------------|-----------------------------------|-----------------------------------|
|1000|2|32|0,3|9|30 (100)
|10 000|4|48|3|90|200 (300)
|40 000|8|64|12|360|500 (1000)
|100 000|12|96|30|900|1000 (1500)
|400 000|40|128|120|1800|2000 (2500)
&#42; Ежедневное среднее количество пакетов в секунду, отправляемых контроллерами домена, которые отслеживают шлюзы ATA.

&#42;&#42; Сюда относятся физические ядра, а не ядра с поддержкой технологии Hyper-Threading.

&#42;&#42;&#42; Средние значения (пиковые значения).
> [!NOTE]
> -   Совокупное максимальное количество обрабатываемых центром ATA кадров в секунду из всех отслеживаемых контроллеров домена составляет 400 000.
> -   Указанные в таблице объемы памяти — это фактические значения. Всегда учитывайте будущий рост нагрузки и помните, что на диске базы данных должно быть по крайней мере 20 % свободного пространства.
> -   Если на диске базы данных остается менее 20 % (100 ГБ) свободного пространства, самая старая коллекция данных будет удалена. Это будет происходить, пока на диске останется только 5 % или 50 ГБ свободного пространства (для хранения данных за 2 дня). Затем сбор данных будет остановлен.
> -  При выполнении действий чтения и записи задержка хранилища должна быть менее 10 мс.
> -  Соотношение между количеством операций чтения и записи должно составлять примерно 1:3 при обработке меньше 100 000 пакетов в секунду и 1:6 при обработке свыше 100 000 пакетов в секунду.

## Выбор правильного типа шлюза для развертывания
В развертывании ATA поддерживается любое сочетание типов шлюза ATA:

- Только шлюзы ATA
- Только упрощенные шлюзы ATA
- Комбинация шлюзов

При выборе типа развертывания шлюза необходимо учитывать следующее:

|Тип шлюза|Преимущества|Стоимость|Топология развертывания|Использование контроллера домена|
|----|----|----|----|-----|
|Шлюз ATA|Внешнее развертывание усложняет обнаружение ATA для злоумышленников|Выше|Устанавливается вместе с контроллером домена (внешняя установка)|Поддерживает до 50 000 пакетов в секунду|
|Упрощенный шлюз ATA|Не требует выделенного сервера и настройки зеркального отражения портов|Нижний|Устанавливается на контроллере домена|Поддерживает до 10 000 пакетов в секунду|

Ниже приведены примеры сценариев, в которых работу всех контроллеров домена контролирует упрощенный шлюз ATA:


- сайты филиалов;

- Виртуальные контроллеры доменов, развернутые в облаке (IaaS)


Ниже приведены примеры сценариев, в которых работу всех контроллеров домена контролирует шлюз ATA:


- Главные центры обработки данных (имеющие контроллеры доменов со скоростью передачи более 10 000 пакетов в секунду)


## Размеры упрощенных шлюзов ATA

Упрощенный шлюз ATA поддерживает отслеживание одного контроллера домена в зависимости от объема сетевого трафика, создаваемого контроллером домена. 
> [!NOTE] 
> При запуске в качестве динамической памяти виртуальной машины или любой другой памяти функция воздушного шага не поддерживается.

|Пакетов в секунду&#42;|Число ядер ЦП&#42;&#42;|Память (ГБ)&#42;&#42;&#42;|
|---------------------------|-------------------------|---------------|
|1000|2|6|
|5000|6|16|
    |10 000|10|24|

&#42; Общее количество пакетов в секунду в контроллере домена, который отслеживает конкретный упрощенный шлюз ATA.

&#42;&#42; Общее количество ядер без применения технологии Hyper-Threading, установленные в этом контроллере домена.<br>Хотя технология Hyper-Threading является приемлемой для упрощенного шлюза ATA, при планировании производительности необходимо подсчитать фактические ядра и ядра без применения технологии Hyper-Threading.

&#42;&#42;&#42;Общий объем памяти, установленной в этом контроллере домена.
> [!NOTE]   
> Если в контроллере домена недостаточно ресурсов, необходимых для упрощенного шлюза ATA, это не повлияет на производительность контроллера домена, но упрощенный шлюз ATA, возможно, не будет работать должным образом.


## Определение размера шлюза ATA

При определении числа шлюзов ATA, которые необходимо развернуть, учитывайте следующее.

-   **Леса и домены Active Directory.**<br>
    ATA может отслеживать трафик из нескольких доменов в рамках одного леса Active Directory. Чтобы выполнять мониторинг нескольких лесов Active Directory, требуются отдельные развертывания ATA. Не следует настраивать одно развертывание ATA для отслеживания сетевого трафика контроллеров домена в разных лесах.

-   **Зеркалирование портов**<br>
Согласно рекомендациям по зеркальному отображению портов, возможно, потребуется развернуть несколько шлюзов ATA в центре данных или на сайте филиала.

-   **Емкость**<br>
    Шлюз ATA поддерживает отслеживание нескольких контроллеров домена в зависимости от объема сетевого трафика отслеживаемых контроллеров домена. 
<br>

> [!NOTE] 
> Динамическая память не поддерживается.

|Пакетов в секунду&#42;|Число ядер ЦП&#42;&#42;|Память (ГБ)|
|---------------------------|-------------------------|---------------|
|1000|1|6|
|5000|2|10|
|10 000|3|12|
|20 000|6|24|
|50 000|16|48|
&#42; Среднее количество пакетов в секунду, отправляемых всеми контроллерами домена, которые отслеживает конкретный шлюз ATA в час наибольшей нагрузки.

&#42; Общий объем зеркально отображенного трафика контроллера домена не может превышать емкость сетевого адаптера в шлюзе ATA.

&#42;&#42; Технология Hyper-Threading должна быть отключена.



## Оценка трафика контроллера домена
Существуют различные инструменты, с помощью которых можно определить среднее число пакетов в секунду, отправляемых с контроллеров домена. Если у вас нет таких инструментов, эти сведения можно отследить с помощью системного монитора.

Чтобы определить число пакетов в секунду, сделайте для каждого контроллера домена следующее:

1.  Откройте системный монитор.

    ![Изображение системного монитора](media/ATA-traffic-estimation-1.png)

2.  Разверните узел **Группы сборщиков данных**.

    ![Изображение узла "Группы сборщиков данных"](media/ATA-traffic-estimation-2.png)

3.  Щелкните правой кнопкой мыши узел **Определяется пользователем** и последовательно выберите **Создать** &gt; **Группа сборщиков данных**.

    ![Изображение окна создания группы сборщиков данных](media/ATA-traffic-estimation-3.png)

4.  Введите имя группы сборщиков данных и установите переключатель **Создать вручную (для опытных)**.

5.  В разделе **Какой тип данных вы хотите использовать?** установите переключатель **Создать журналы данных и счетчик производительности**.

    ![Изображение окна выбора типа данных для новой группы сборщиков данных](media/ATA-traffic-estimation-5.png)

6.  В разделе **Данные каких счетчиков производительности следует записывать в журнал?** выберите команду **Добавить**.

7.  Разверните узел **Сетевой адаптер**, выберите пункт **Пакетов/с** и выберите подходящий экземпляр. Если вы не уверены, выберите значение **&lt;Все экземпляры&gt;** и нажмите кнопку **Добавить**, а затем — **ОК**.

    > [!NOTE]
    > Чтобы увидеть имя адаптера и сведения о конфигурации, введите в командной строке команду `ipconfig /all`.

    ![Изображение окна добавления счетчиков производительности](media/ATA-traffic-estimation-7.png)

8.  Установите для параметра **Интервал выборки** значение **1 секунда**.

9. Задайте папку для хранения данных.

10. В разделе **Создать группу сборщиков данных** установите переключатель **Запустить группу сборщиков данных сейчас** и нажмите кнопку **Готово**.

    После этого отобразится новая группа сборщиков данных с зеленым треугольником, который указывает на то, что она активна.

11. Через 24 часа остановите группу сборщиков данных, щелкнув ее правой кнопкой мыши и выбрав **Остановить**.

    ![Изображения остановки группы сборщиков данных](media/ATA-traffic-estimation-12.png)

12. В проводнике перейдите к папке, в которой сохранен BLG-файл, и дважды щелкните его, чтобы открыть в системном мониторе.

13. Выберите счетчик пакетов в секунду и запишите приведенные в нем среднее и максимальные значения.

    ![Изображения счетчика пакетов в секунду](media/ATA-traffic-estimation-14.png)

## См. также
- [Предварительные требования для ATA](ata-prerequisites.md)
- [Архитектура ATA](ata-architecture.md)
- [Обязательно ознакомьтесь с форумом ATA.](https://social.technet.microsoft.com/Forums/security/home?forum=mata)



<!--HONumber=Jul16_HO3-->


